{% extends 'base.html' %}
{% block content %}
<!-- Begin page content -->
<main role="main" class="container">
	<div class="contain">
	  <div class="left-half round">
		<h4>{Event ID | Event Name} - Add/Remove Player</h4><br/>
		<h6>Currently Registered Players:</h6>
		<table class="table table-hover table-dark">
		   <tr>
		      <th>Player Name</th><th>Group</th>
		   </tr>
		   <!-- Foreach Players & Group -->
		   {% for player in registered_players%}
			<tr>
				<th>{{player.Name}}</th><th>{{player.divisions[0].Division}}</th>
			</tr>
		   {% endfor %}
        </table>		
	  </div><br/>
	  <div class="right-half round">
		<h4>{Event ID | Event Name} - Add/Remove Player</h4><br/>
		<form id="editevent_player" method="POST">
			<p id="actionSelect">Action:
			  <select id="action_select" name="action" class="form-control" required>
			  	<option value="" disabled selected>Select a Action...</option>
			    <option value="add">Add</option>
				<option value="remove">Remove</option>
			  </select>
			</p>
			<p id="playerSelect">Choose Player: 
			  <select id="player_select" name="player" class="form-control" required>
			    <!-- Foreach Player in Event -->
				<option value="">Select a Action...</option>
			  </select>
			</p>
			<p id="groupSelect">Choose Group: 
			  <select name="group_select" class="form-control">
			    <!-- Foreach Group in Event -->
			  </select>
			</p>
			<center><br/>
				<button type="submit" class="btn btn-success" id="addevent" name="submit" value="submit">Save</button>
				<button type="button" class="btn btn-primary" id="changeEvent" onclick="window.location='{{ url_for('editevent_landing') }}'">Change Event</button>
				<button type="button" class="btn btn-info" onclick="window.location='{{ url_for('admin') }}'"><i class="fas fa-backward"></i> Admin </button>
			</center>
		</form><br/>
		<!--Confirmation message needs to show when page is validated-->
		<div class="alert alert-info alert-dismissible text-center" id="alert_addgroup" role="alert">{Player added/removed successfully}</div>
	  </div>
	</div>

	<script>
		$(document).ready(function(){
			$('#playerSelect').hide();
			$('#groupSelect').hide();

			$('#action_select').change(function () {
				$('#playerSelect').show();

				var fetch = $(this).val();
				$.ajax({
					type: "POST",
					url: "editevent_player/registered_users",
					data: { "action":fetch },
					success: function (response) {
						$(player_select).html(response)
					},
					error: function (event, request, settings) {
						console.log('AjaxError' + ' : ' + settings);
					},
					timeout: 20000
				});
			});

			$('#player_select').change(function () {
				$('#groupSelect').show();

				var fetch = $(this).val();
				$.ajax({
					type: "POST",
					url: "editevent_player/registered_users",
					data: { "action":fetch },
					success: function (response) {
						$(player_select).html(response)
					},
					error: function (event, request, settings) {
						console.log('AjaxError' + ' : ' + settings);
					},
					timeout: 20000
				});
			});
	});
	</script>
</main>
{% endblock %}